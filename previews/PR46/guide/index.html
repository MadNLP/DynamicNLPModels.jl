<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quick Start · DynamicNLPModels</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DynamicNLPModels</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Quick Start</a><ul class="internal"><li><a class="tocitem" href="#SparseLQDynamicModel"><span><code>SparseLQDynamicModel</code></span></a></li><li><a class="tocitem" href="#DenseLQDynamicModel"><span><code>DenseLQDynamicModel</code></span></a></li><li><a class="tocitem" href="#API-functions"><span>API functions</span></a></li></ul></li><li><a class="tocitem" href="../api/">API Manual</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quick Start</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quick Start</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MadNLP/DynamicNLPModels.jl/blob/main/docs/src/guide.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><p>DynamicNLPModels.jl takes user defined data to construct a linear MPC problem of the form</p><p class="math-container">\[\begin{aligned}
\min_{s, u, v} &amp;\; s_N^\top Q_f s_N + \frac{1}{2} \sum_{i = 0}^{N-1} \left[ \begin{array}{c} s_i \\ u_i \end{array} \right]^\top \left[ \begin{array}{cc} Q &amp; S \\ S^\top &amp; R \end{array} \right] \left[ \begin{array}{c} s_i \\ u_i \end{array} \right]\\
          \textrm{s.t.} &amp;\;s_{i+1} = As_i + Bu_i + w_i \quad \forall i = 0, 1, \cdots, N - 1 \\
          &amp;\; u_i = Ks_i + v_i \quad  \forall i = 0, 1, \cdots, N - 1 \\
          &amp;\; g^l \le E s_i + F u_i \le g^u \quad \forall i = 0, 1, \cdots, N - 1\\
          &amp;\; s^l \le s_i \le s^u \quad \forall i = 0, 1, \cdots, N \\
          &amp;\; u^l \le u_i \le u^u \quad \forall i = 0, 1, \cdots, N - 1\\
          &amp;\; s_0 = \bar{s}.
\end{aligned}\]</p><p>This data is stored within the struct <code>LQDynamicData</code>, which can be created by passing the data <code>s0</code>, <code>A</code>, <code>B</code>, <code>Q</code>, <code>R</code> and <code>N</code> to the constructor as in the example below. </p><pre><code class="language-julia hljs">using DynamicNLPModels, Random, LinearAlgebra

Q  = 1.5 * Matrix(I, (3, 3))
R  = 2.0 * Matrix(I, (2, 2))
A  = rand(3, 3)
B  = rand(3, 2)
N  = 5
s0 = [1.0, 2.0, 3.0]

lqdd = LQDynamicData(s0, A, B, Q, R, N; **kwargs)</code></pre><p><code>LQDynamicData</code> contains the following fields. All fields after <code>R</code> are keyword arguments:</p><ul><li><code>ns</code>: number of states (determined from size of <code>Q</code>)</li><li><code>nu</code>: number of inputs (determined from size of <code>R</code>)</li><li><code>N</code> : number of time steps</li><li><code>s0</code>: a vector of initial states</li><li><code>A</code> : matrix that is multiplied by the states that corresponds to the dynamics of the problem. Number of columns is equal to <code>ns</code></li><li><code>B</code> : matrix that is multiplied by the inputs that corresonds to the dynamics of the problem. Number of columns is equal to <code>nu</code></li><li><code>Q</code> : objective function matrix for system states from <span>$0, 1, \cdots, (N - 1)$</span></li><li><code>R</code> : objective function matrix for system inputs from <span>$0, 1, \cdots, (N - 1)$</span></li><li><code>Qf</code>: objective function matrix for system states at time <span>$N$</span></li><li><code>S</code> : objective function matrix for system states and inputs</li><li><code>E</code> : constraint matrix multiplied by system states. Number of columns is equal to <code>ns</code></li><li><code>F</code> : constraint matrix multiplied by system inputs. Number of columns is equal to <code>nu</code></li><li><code>K</code> : feedback gain matrix. Used to ensure numerical stability of the condensed problem. Not necessary within the sparse problem</li><li><code>w</code> : constant term within dynamic constraints. At this time, this is the only data that is time varying. This vector must be length <code>ns</code> * <code>N</code>, where each set of <code>ns</code> entries corresponds to that time (i.e., entries <code>1:ns</code> correspond to time <span>$0$</span>, entries <code>(ns + 1):(2 * ns)</code> corresond to time <span>$1$</span>, etc.)</li><li><code>sl</code> : lower bounds on state variables</li><li><code>su</code> : upper bounds on state variables </li><li><code>ul</code> : lower bounds on ipnut variables</li><li><code>uu</code> : upper bounds on input variables</li><li><code>gl</code> : lower bounds on the constraints <span>$Es_i + Fu_i$</span></li><li><code>gu</code> : upper bounds on the constraints <span>$Es_i + Fu_i$</span></li></ul><h2 id="SparseLQDynamicModel"><a class="docs-heading-anchor" href="#SparseLQDynamicModel"><code>SparseLQDynamicModel</code></a><a id="SparseLQDynamicModel-1"></a><a class="docs-heading-anchor-permalink" href="#SparseLQDynamicModel" title="Permalink"></a></h2><p>A <code>SparseLQDynamicModel</code> can be created by either passing <code>LQDynamicData</code> to the constructor or passing the data itself, where the same keyword options exist which can be used for <code>LQDynamicData</code>. </p><pre><code class="language-julia hljs">sparse_lqdm = SparseLQDynamicModel(lqdd)

# or 

sparse_lqdm = SparseLQDynamicModel(s0, A, B, Q, R, N; **kwargs)</code></pre><p>The <code>SparseLQDynamicModel</code> contains four fields:</p><ul><li><code>dynamic_data</code> which contains the <code>LQDynamicData</code></li><li><code>data</code> which is the <code>QPData</code> from <a href="https://github.com/JuliaSmoothOptimizers/QuadraticModels.jl">QuadraticModels.jl</a>. This object also contains the following data:<ul><li><code>H</code> which is the Hessian of the linear MPC problem </li><li><code>A</code> which is the Jacobian of the linear MPC problem such that <span>$\textrm{lcon} \le A z \le \textrm{ucon}$</span></li><li><code>c</code> which is the linear term of a quadratic objective function</li><li><code>c0</code> which is the constant term of a quadratic objective function</li></ul></li><li><code>meta</code> which contains the <code>NLPModelMeta</code> for the problem from NLPModels.jl</li><li><code>counters</code> which is the <code>Counters</code> object from NLPModels.jl</li></ul><p>!!! Note     The <code>SparseLQDynamicModel</code> requires that all matrices in the <code>LQDynamicData</code> be the same type. It is recommended that the user be aware of how to most efficiently store their data in the <code>Q</code>, <code>R</code>, <code>A</code>, and <code>B</code> matrices as this impacts how efficiently the <code>SparseLQDynamicModel</code> is constructed. When <code>Q</code>, <code>R</code>, <code>A</code>, and <code>B</code> are sparse, building the <code>SparseLQDynamicModel</code> is much faster when these are passed as sparse rather than dense matrices. </p><h2 id="DenseLQDynamicModel"><a class="docs-heading-anchor" href="#DenseLQDynamicModel"><code>DenseLQDynamicModel</code></a><a id="DenseLQDynamicModel-1"></a><a class="docs-heading-anchor-permalink" href="#DenseLQDynamicModel" title="Permalink"></a></h2><p>The <code>DenseLQDynamicModel</code> eliminates the states within the linear MPC problem to build an equivalent optimization problem that is only a function of the inputs. This can be particularly useful when the number of states is large compared to the number of inputs.</p><p>A <code>DenseLQDynamicModel</code> can be created by either passing <code>LQDynamicData</code> to the constructor or passing the data itself, where the same keyword options exist which can be used for <code>LQDynamicData</code>. </p><pre><code class="language-julia hljs">dense_lqdm = DenseLQDynamicModel(lqdd)

# or 

dense_lqdm = DenseLQDynamicModel(s0, A, B, Q, R, N; **kwargs)</code></pre><p>The <code>DenseLQDynamicModel</code> contains five fields:</p><ul><li><code>dynamic_data</code> which contains the <code>LQDynamicData</code></li><li><code>data</code> which is the <code>QPData</code> from <a href="https://github.com/JuliaSmoothOptimizers/QuadraticModels.jl">QuadraticModels.jl</a>. This object also contains the following data:<ul><li><code>H</code> which is the Hessian of the condensed linear MPC problem </li><li><code>A</code> which is the Jacobian of the condensed linear MPC problem such that <span>$\textrm{lcon} \le A z \le \textrm{ucon}$</span></li><li><code>c</code> which is the linear term of the condensed linear MPC problem </li><li><code>c0</code> which is the constant term of the condensed linear MPC problem</li></ul></li><li><code>meta</code> which contains the <code>NLPModelMeta</code> for the problem from NLPModels.jl</li><li><code>counters</code> which is the <code>Counters</code> object from NLPModels.jl</li><li><code>blocks</code> which contains the data needed to condense the model and then to update the condensed model when <code>s0</code> is reset. </li></ul><p>The <code>DenseLQDynamicModel</code> is formed from dense matrices, and this dense system can be solved on a GPU using MadNLP.jl and MadNLPGPU.jl For an example script for performing this, please see the the <a href="https://github.com/MadNLP/DynamicNLPModels.jl/tree/main/examples">examples directory</a> of the main repository.</p><h2 id="API-functions"><a class="docs-heading-anchor" href="#API-functions">API functions</a><a id="API-functions-1"></a><a class="docs-heading-anchor-permalink" href="#API-functions" title="Permalink"></a></h2><p>An API has been created for working with <code>LQDynamicData</code> and the sparse and dense models. All functions can be seen in the API Manual section. However, we give a short overview of these functions here. </p><ul><li><code>reset_s0!(LQDynamicModel, new_s0)</code>: resets the model in place with a new <code>s0</code> value. This could be called after each sampling period in MPC to reset the model with a new measured value</li><li><code>get_s(solver_ref, LQDynamicModel)</code>: returns the optimal solution for the states from a given solver reference</li><li><code>get_u(solver_ref, LQDynamicModel)</code>: returns the optimal solution for the inputs from a given solver reference; when <code>K</code> is defined, the solver reference contains the optimal <span>$v$</span> values rather than optimal <span>$u$</span> values, adn this function converts <span>$v$</span> to <span>$u$</span> and returns the <span>$u$</span> values</li><li><code>get_*</code>:  returns the data of <code>*</code> where <code>*</code> is an object within <code>LQDynamicData</code></li><li><code>set_*!</code>: sets the value within the data of <code>*</code> for a given entry to a user defined value</li></ul><pre><code class="nohighlight hljs"></code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../api/">API Manual »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 26 August 2022 17:20">Friday 26 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
